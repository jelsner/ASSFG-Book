<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>1 Standardized Incidence Ratios | Applied Spatial Statistics for Geographers</title>
  <meta name="description" content="1 Standardized Incidence Ratios | Applied Spatial Statistics for Geographers" />
  <meta name="generator" content="bookdown 0.18 and GitBook 2.6.7" />

  <meta property="og:title" content="1 Standardized Incidence Ratios | Applied Spatial Statistics for Geographers" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="1 Standardized Incidence Ratios | Applied Spatial Statistics for Geographers" />
  
  
  

<meta name="author" content="James B. Elsner" />


<meta name="date" content="2020-05-14" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="index.html"/>

<script src="libs/header-attrs-2.1/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="standardized-incidence-ratios.html"><a href="standardized-incidence-ratios.html"><i class="fa fa-check"></i><b>1</b> Standardized Incidence Ratios</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Applied Spatial Statistics for Geographers</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="standardized-incidence-ratios" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Standardized Incidence Ratios</h1>
<p>This material is taken from Chapter 5 of <span class="citation">Moraga (<a href="#ref-Moraga2020" role="doc-biblioref">2020</a>)</span>.</p>
<p>A simple measure of disease risk in areas is the standardized incidence ratio (SIR) which is defined as the ratio of the observed to the expected counts. However, in many situations small areas may present extreme SIRs due to low population sizes or small samples. In these situations, SIRs may be misleading and insufficiently reliable for reporting. In these cases it is better to estimate disease risk using a spatial statistical model. Models can incorporate information from neighboring areas and covariate information resulting in smoothing (shrinking) of extreme values.</p>
<p>A popular spatial statistical model is the Besag-York-Mollié (BYM) model <span class="citation">(Besag, York, and Mollie <a href="#ref-BesagEtAl1991" role="doc-biblioref">1991</a>)</span> which takes into account that data may be spatially correlated and observations in neighboring areas may be more similar than observations in areas that are farther away. This model includes a spatial random effect that smooths the data according to a neighborhood structure, and an unstructured exchangeable component that models uncorrelated noise. In spatio-temporal settings where disease counts are observed over time, spatio-temporal models that account for spatial structure and temporal correlations and their interactions are used.</p>
<p>The example here is based on data of lung cancer in Pennsylvania counties, US, obtained from the {SpatialEpi} package <span class="citation">(Kim and Wakefield <a href="#ref-KimWakefield2018" role="doc-biblioref">2018</a>)</span>, and show results with maps created with the {ggplot2} package <span class="citation">(Wickham <a href="#ref-Wickham2016" role="doc-biblioref">2016</a>)</span>.</p>
<p>The county bounderies for the state are in the list object <code>pennLC</code> with element name <code>spatial.polygon</code>. We change the spatial polygons S4 object to an S3 simple feature data frame and make a map using the <code>st_as_sf()</code> function from the {sf} package <span class="citation">(Pebesma <a href="#ref-Pebesma2018" role="doc-biblioref">2018</a>)</span></p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="standardized-incidence-ratios.html#cb1-1"></a><span class="kw">library</span>(SpatialEpi)</span></code></pre></div>
<pre><code>## Loading required package: sp</code></pre>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="standardized-incidence-ratios.html#cb3-1"></a><span class="kw">library</span>(sf)</span></code></pre></div>
<pre><code>## Linking to GEOS 3.7.2, GDAL 2.4.2, PROJ 5.2.0</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="standardized-incidence-ratios.html#cb5-1"></a>spdf &lt;-<span class="st"> </span>pennLC<span class="op">$</span>spatial.polygon</span>
<span id="cb5-2"><a href="standardized-incidence-ratios.html#cb5-2"></a>sfdf &lt;-<span class="st"> </span><span class="kw">st_as_sf</span>(spdf)</span>
<span id="cb5-3"><a href="standardized-incidence-ratios.html#cb5-3"></a><span class="kw">plot</span>(sfdf<span class="op">$</span>geometry)</span></code></pre></div>
<p><img src="assfg-book_files/figure-html/unnamed-chunk-1-1.png" width="672" /></p>
<p>We can obtain the neighbors of each county using the <code>poly2nb()</code> function from the {spdep} package <span class="citation">(Bivand, Pebesma, and Gomez-Rubio <a href="#ref-BivandEtAl2008" role="doc-biblioref">2008</a>)</span>. This function returns a neighbors list <code>nb</code> based on counties with contiguous boundaries. Each element of the list <code>nb</code> represents one county and contains the indices of its neighbors. For example, <code>nb[[2]]</code> contains the neighbors of county 2.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="standardized-incidence-ratios.html#cb6-1"></a><span class="kw">library</span>(spdep)</span></code></pre></div>
<pre><code>## Loading required package: spData</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="standardized-incidence-ratios.html#cb8-1"></a>nb &lt;-<span class="st"> </span><span class="kw">poly2nb</span>(sfdf)</span>
<span id="cb8-2"><a href="standardized-incidence-ratios.html#cb8-2"></a><span class="kw">head</span>(nb)</span></code></pre></div>
<pre><code>## [[1]]
## [1] 21 28 67
## 
## [[2]]
## [1]  3  4 10 63 65
## 
## [[3]]
## [1]  2 10 16 32 33 65
## 
## [[4]]
## [1]  2 10 37 63
## 
## [[5]]
## [1]  7 11 29 31 56
## 
## [[6]]
## [1] 15 36 38 39 46 54</code></pre>
<p>We show the neighbors of each county on a map. For example, we can show the neighbors of counties 2, 44 and 58. First, we create a SpatialPolygonsDataFrame object with the map of Pennsylvania, and data that contains a variable called county with the county names, and a dummy variable called neigh that indicates the neighbors of counties 2, 44 and 58. neigh is equal to 1 for counties that are neighbors of counties 2, 44 and 58, and 0 otherwise.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="standardized-incidence-ratios.html#cb10-1"></a>df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">county =</span> <span class="kw">names</span>(spdf), </span>
<span id="cb10-2"><a href="standardized-incidence-ratios.html#cb10-2"></a>                 <span class="dt">neigh =</span> <span class="kw">rep</span>(<span class="dv">0</span>, <span class="kw">length</span>(spdf)))</span>
<span id="cb10-3"><a href="standardized-incidence-ratios.html#cb10-3"></a><span class="kw">rownames</span>(df) &lt;-<span class="st"> </span><span class="kw">names</span>(spdf)</span>
<span id="cb10-4"><a href="standardized-incidence-ratios.html#cb10-4"></a></span>
<span id="cb10-5"><a href="standardized-incidence-ratios.html#cb10-5"></a>spdf &lt;-<span class="st"> </span><span class="kw">SpatialPolygonsDataFrame</span>(spdf, df, <span class="dt">match.ID =</span> <span class="ot">TRUE</span>)</span>
<span id="cb10-6"><a href="standardized-incidence-ratios.html#cb10-6"></a></span>
<span id="cb10-7"><a href="standardized-incidence-ratios.html#cb10-7"></a>spdf<span class="op">$</span>neigh[nb[[<span class="dv">2</span>]]] &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb10-8"><a href="standardized-incidence-ratios.html#cb10-8"></a>spdf<span class="op">$</span>neigh[nb[[<span class="dv">44</span>]]] &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb10-9"><a href="standardized-incidence-ratios.html#cb10-9"></a>spdf<span class="op">$</span>neigh[nb[[<span class="dv">58</span>]]] &lt;-<span class="st"> </span><span class="dv">1</span></span></code></pre></div>
<p>Then, we add variables called <code>long</code> and <code>lat</code> with the centroid coordinates for each county, and a variable <code>ID</code> identifying each county.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="standardized-incidence-ratios.html#cb11-1"></a>coord &lt;-<span class="st"> </span><span class="kw">st_coordinates</span>(<span class="kw">st_centroid</span>(sfdf))</span></code></pre></div>
<pre><code>## Warning in st_centroid.sfc(st_geometry(x), of_largest_polygon =
## of_largest_polygon): st_centroid does not give correct centroids for longitude/
## latitude data</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="standardized-incidence-ratios.html#cb13-1"></a>sfdf<span class="op">$</span>neigh &lt;-<span class="st"> </span>spdf<span class="op">$</span>neigh</span>
<span id="cb13-2"><a href="standardized-incidence-ratios.html#cb13-2"></a>sfdf<span class="op">$</span>long &lt;-<span class="st"> </span>coord[, <span class="dv">1</span>]</span>
<span id="cb13-3"><a href="standardized-incidence-ratios.html#cb13-3"></a>sfdf<span class="op">$</span>lat &lt;-<span class="st"> </span>coord[, <span class="dv">2</span>]</span>
<span id="cb13-4"><a href="standardized-incidence-ratios.html#cb13-4"></a>sfdf<span class="op">$</span>ID &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(coord)</span></code></pre></div>
<p>We create the map with the <code>ggplot()</code> function from {ggplot2}.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="standardized-incidence-ratios.html#cb14-1"></a><span class="kw">library</span>(ggplot2)</span>
<span id="cb14-2"><a href="standardized-incidence-ratios.html#cb14-2"></a></span>
<span id="cb14-3"><a href="standardized-incidence-ratios.html#cb14-3"></a><span class="kw">ggplot</span>(sfdf) <span class="op">+</span><span class="st"> </span></span>
<span id="cb14-4"><a href="standardized-incidence-ratios.html#cb14-4"></a><span class="st">  </span><span class="kw">geom_sf</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> <span class="kw">as.factor</span>(neigh))) <span class="op">+</span></span>
<span id="cb14-5"><a href="standardized-incidence-ratios.html#cb14-5"></a><span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(long, lat, <span class="dt">label =</span> ID), <span class="dt">color =</span> <span class="st">&quot;white&quot;</span>) <span class="op">+</span></span>
<span id="cb14-6"><a href="standardized-incidence-ratios.html#cb14-6"></a><span class="st">  </span><span class="kw">theme_minimal</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb14-7"><a href="standardized-incidence-ratios.html#cb14-7"></a><span class="st">  </span><span class="kw">guides</span>(<span class="dt">fill =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<p><img src="assfg-book_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>

<div id="refs" class="references hanging-indent">
<div>
<p>Besag, J., J. York, and A. Mollie. 1991. “Bayesian image restoration, with two applications in spatial statistics.” <em>Annals of the Institute of Statistical Mathematics</em> 43: 1–59.</p>
</div>
<div>
<p>Bivand, R., E. Pebesma, and V. Gomez-Rubio. 2008. <em>Applied Spatial Data Analysis with R</em>. New York: Springer.</p>
</div>
<div>
<p>Kim, Albert Y., and Jon Wakefield. 2018. <em>SpatialEpi: Methods and Data for Spatial Epidemiology</em>. <a href="https://CRAN.R-project.org/package=SpatialEpi">https://CRAN.R-project.org/package=SpatialEpi</a>.</p>
</div>
<div>
<p>Moraga, Paula. 2020. <em>Geospatial Health Data: Modeling and Visualization with R-Inla and Shiny</em>. Boca Raton: CRC Press.</p>
</div>
<div>
<p>Pebesma, Edzer. 2018. “Simple Features for R: Standardized Support for Spatial Vector Data.” <em>The R Journal</em> 10 (1): 439–46. <a href="https://doi.org/10.32614/RJ-2018-009">https://doi.org/10.32614/RJ-2018-009</a>.</p>
</div>
<div>
<p>Wickham, Hadley. 2016. <em>Ggplot2: Elegant Graphics for Data Analysis</em>. Springer-Verlag New York. <a href="https://ggplot2.tidyverse.org">https://ggplot2.tidyverse.org</a>.</p>
</div>
</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-BesagEtAl1991">
<p>Besag, J., J. York, and A. Mollie. 1991. “Bayesian image restoration, with two applications in spatial statistics.” <em>Annals of the Institute of Statistical Mathematics</em> 43: 1–59.</p>
</div>
<div id="ref-BivandEtAl2008">
<p>Bivand, R., E. Pebesma, and V. Gomez-Rubio. 2008. <em>Applied Spatial Data Analysis with R</em>. New York: Springer.</p>
</div>
<div id="ref-KimWakefield2018">
<p>Kim, Albert Y., and Jon Wakefield. 2018. <em>SpatialEpi: Methods and Data for Spatial Epidemiology</em>. <a href="https://CRAN.R-project.org/package=SpatialEpi">https://CRAN.R-project.org/package=SpatialEpi</a>.</p>
</div>
<div id="ref-Moraga2020">
<p>Moraga, Paula. 2020. <em>Geospatial Health Data: Modeling and Visualization with R-Inla and Shiny</em>. Boca Raton: CRC Press.</p>
</div>
<div id="ref-Pebesma2018">
<p>Pebesma, Edzer. 2018. “Simple Features for R: Standardized Support for Spatial Vector Data.” <em>The R Journal</em> 10 (1): 439–46. <a href="https://doi.org/10.32614/RJ-2018-009">https://doi.org/10.32614/RJ-2018-009</a>.</p>
</div>
<div id="ref-Wickham2016">
<p>Wickham, Hadley. 2016. <em>Ggplot2: Elegant Graphics for Data Analysis</em>. Springer-Verlag New York. <a href="https://ggplot2.tidyverse.org">https://ggplot2.tidyverse.org</a>.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["assfg-book.pdf", "assfg-book.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
